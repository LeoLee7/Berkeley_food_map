<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Berkeley Weekend Eats</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:ital,wght@0,400;0,600;1,400&family=DM+Sans:wght@300;400;500&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <style>
    :root {
      --cream: #f7f3ee;
      --warm-white: #faf8f5;
      --forest: #2c3e2d;
      --forest-light: #3d5c3e;
      --terra: #c0612b;
      --terra-light: #e8794a;
      --gold: #c9a84c;
      --muted: #8a8278;
      --border: #e0d9d0;
      --card-bg: #ffffff;
    }

    * { box-sizing: border-box; margin: 0; padding: 0; }

    body {
      font-family: 'DM Sans', sans-serif;
      background: var(--cream);
      color: var(--forest);
      height: 100vh;
      display: flex;
      flex-direction: column;
      overflow: hidden;
    }

    /* ‚îÄ‚îÄ Header ‚îÄ‚îÄ */
    header {
      background: var(--forest);
      color: var(--cream);
      padding: 14px 28px;
      display: flex;
      align-items: baseline;
      gap: 18px;
      flex-shrink: 0;
    }
    header h1 {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.75rem;
      font-weight: 600;
      letter-spacing: 0.01em;
    }
    header h1 span { color: var(--gold); font-style: italic; }
    header p {
      font-size: 0.8rem;
      color: #a8b8a9;
      font-weight: 300;
    }

    /* ‚îÄ‚îÄ Layout ‚îÄ‚îÄ */
    .layout {
      display: flex;
      flex: 1;
      overflow: hidden;
    }

    /* ‚îÄ‚îÄ Sidebar ‚îÄ‚îÄ */
    .sidebar {
      width: 380px;
      flex-shrink: 0;
      background: var(--warm-white);
      overflow-y: auto;
      border-right: 1px solid var(--border);
      display: flex;
      flex-direction: column;
    }
    .sidebar::-webkit-scrollbar { width: 5px; }
    .sidebar::-webkit-scrollbar-thumb { background: var(--border); border-radius: 4px; }

    /* ‚îÄ‚îÄ Itinerary ‚îÄ‚îÄ */
    .itinerary {
      padding: 20px 22px;
      border-bottom: 1px solid var(--border);
    }
    .section-label {
      font-size: 0.65rem;
      font-weight: 500;
      letter-spacing: 0.12em;
      text-transform: uppercase;
      color: var(--terra);
      margin-bottom: 14px;
    }
    .day-block { margin-bottom: 18px; }
    .day-title {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.1rem;
      font-weight: 600;
      color: var(--forest);
      margin-bottom: 10px;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .day-title::after {
      content: '';
      flex: 1;
      height: 1px;
      background: var(--border);
    }
    .meal-row {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 8px 0;
      border-bottom: 1px dashed var(--border);
      cursor: pointer;
      transition: background 0.15s;
      border-radius: 4px;
      padding: 7px 6px;
    }
    .meal-row:last-child { border-bottom: none; }
    .meal-row:hover { background: #f0ede8; }
    .meal-time {
      font-size: 0.68rem;
      font-weight: 500;
      color: var(--muted);
      letter-spacing: 0.05em;
      text-transform: uppercase;
      width: 50px;
      flex-shrink: 0;
      padding-top: 2px;
    }
    .meal-info { flex: 1; }
    .meal-name {
      font-size: 0.88rem;
      font-weight: 500;
      color: var(--forest);
    }
    .meal-tag {
      font-size: 0.72rem;
      color: var(--muted);
      margin-top: 2px;
    }
    .meal-star {
      width: 20px;
      height: 20px;
      background: var(--terra);
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      font-size: 0.6rem;
      color: white;
      margin-top: 1px;
    }

    /* ‚îÄ‚îÄ Restaurant List ‚îÄ‚îÄ */
    .rest-list {
      padding: 18px 22px;
    }
    .rest-card {
      display: flex;
      align-items: flex-start;
      gap: 10px;
      padding: 9px 8px;
      border-radius: 6px;
      cursor: pointer;
      transition: background 0.15s, transform 0.1s;
      border: 1px solid transparent;
    }
    .rest-card:hover {
      background: #f0ede8;
      border-color: var(--border);
    }
    .rest-card.highlight {
      background: #fff7f2;
      border-color: #f0c5a8;
    }
    .rest-card.highlight .rest-name { color: var(--terra); }
    .pin-dot {
      width: 22px;
      height: 22px;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 0.65rem;
      font-weight: 500;
      flex-shrink: 0;
      margin-top: 1px;
      color: white;
    }
    .pin-dot.japanese { background: #5b7fa6; }
    .pin-dot.chinese  { background: #c04a2a; }
    .pin-dot.thai     { background: #2d8c5e; }
    .pin-dot.spanish  { background: #b8831a; }
    .pin-dot.korean   { background: #8a4fa8; }
    .pin-dot.other    { background: #6b8a7a; }
    .pin-dot.seafood  { background: #2c7098; }
    .pin-dot.brazilian{ background: #3a7a35; }
    .pin-dot.dessert  { background: #b05080; }
    .rest-info { flex: 1; }
    .rest-name {
      font-size: 0.875rem;
      font-weight: 500;
    }
    .rest-meta {
      font-size: 0.72rem;
      color: var(--muted);
      margin-top: 2px;
    }
    .star-badge {
      font-size: 0.65rem;
      background: var(--terra);
      color: white;
      padding: 2px 6px;
      border-radius: 3px;
      margin-left: 5px;
    }

    /* ‚îÄ‚îÄ Map ‚îÄ‚îÄ */
    #map {
      flex: 1;
      z-index: 0;
    }

    /* ‚îÄ‚îÄ Leaflet custom popup ‚îÄ‚îÄ */
    .leaflet-popup-content-wrapper {
      border-radius: 8px;
      box-shadow: 0 4px 20px rgba(0,0,0,0.15);
      font-family: 'DM Sans', sans-serif;
      border-top: 3px solid var(--terra);
    }
    .leaflet-popup-content { margin: 12px 14px; }
    .popup-name {
      font-family: 'Cormorant Garamond', serif;
      font-size: 1.05rem;
      font-weight: 600;
      color: var(--forest);
    }
    .popup-cuisine {
      font-size: 0.75rem;
      color: var(--muted);
      margin-top: 2px;
    }
    .popup-note {
      font-size: 0.78rem;
      color: var(--forest);
      margin-top: 7px;
      line-height: 1.5;
    }
    .popup-highlight {
      display: inline-block;
      margin-top: 7px;
      font-size: 0.7rem;
      background: #fff2eb;
      color: var(--terra);
      padding: 2px 7px;
      border-radius: 3px;
      font-weight: 500;
    }

    /* ‚îÄ‚îÄ Legend ‚îÄ‚îÄ */
    .legend {
      position: absolute;
      bottom: 24px;
      right: 12px;
      background: white;
      border-radius: 8px;
      padding: 10px 12px;
      box-shadow: 0 2px 12px rgba(0,0,0,0.12);
      z-index: 500;
      font-size: 0.72rem;
      font-family: 'DM Sans', sans-serif;
    }
    .legend-title {
      font-weight: 500;
      color: var(--muted);
      letter-spacing: 0.08em;
      text-transform: uppercase;
      font-size: 0.64rem;
      margin-bottom: 7px;
    }
    .legend-row {
      display: flex; align-items: center; gap: 7px; margin: 3px 0;
      padding: 3px 6px; border-radius: 4px; cursor: pointer;
      transition: background 0.15s; user-select: none;
    }
    .legend-row:hover { background: #f0ede8; }
    .legend-row.active { background: var(--forest); color: white; }
    .legend-row.active svg rect, .legend-row.active svg circle { fill: white !important; }
    .legend-dot { width: 11px; height: 11px; border-radius: 50%; flex-shrink: 0; }

    .filter-bar {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      padding: 10px 22px 0;
    }
    .filter-btn {
      font-family: 'DM Sans', sans-serif;
      font-size: 0.7rem;
      padding: 3px 10px;
      border-radius: 20px;
      border: 1px solid var(--border);
      background: white;
      color: var(--forest);
      cursor: pointer;
      transition: all 0.15s;
    }
    .filter-btn:hover, .filter-btn.active {
      background: var(--forest);
      color: white;
      border-color: var(--forest);
    }
    .meal-name a, .rest-name a {
      color: inherit;
      text-decoration: none;
      border-bottom: 1px solid var(--border);
      transition: color 0.15s, border-color 0.15s;
    }
    .meal-name a:hover, .rest-name a:hover {
      color: var(--terra);
      border-bottom-color: var(--terra);
    }
  </style>
</head>
<body>

<header>
  <h1>Berkeley <span>Weekend Eats</span></h1>
  <p>Jones Berkeley ¬∑ Aiden by Best Western ¬∑ 2 days</p>
</header>

<div class="layout">
  <!-- Sidebar -->
  <div class="sidebar">

    <!-- Itinerary -->
    <div class="itinerary">
      <div class="section-label">Recommended Itinerary</div>

      <div class="day-block">
        <div class="day-title">Saturday</div>
        <div class="meal-row" onclick="focusRestaurant('tanzees')">
          <div class="meal-time">Brunch</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Tanzies+1453+Dwight+Way+Berkeley+CA" target="_blank">Tanzie's (Ê∏ÖËøà)</a></div>
            <div class="meal-tag">Thai brunch ¬∑ walk-in ¬∑ casual start</div>
          </div>
          <div class="meal-star">‚òÖ</div>
        </div>
        <div class="meal-row" onclick="focusRestaurant('yume-mori')">
          <div class="meal-time">Snack</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Yume+Mori+Berkeley+CA" target="_blank">Yume Mori</a></div>
            <div class="meal-tag">Matcha crepe ¬∑ College Ave stroll after</div>
          </div>
        </div>
        <div class="meal-row" onclick="focusRestaurant('la-marcha')">
          <div class="meal-time">Dinner</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=La+Marcha+Tapas+Bar+2026+San+Pablo+Ave+Berkeley+CA" target="_blank">La Marcha Tapas Bar</a></div>
            <div class="meal-tag">Walk-in friendly ¬∑ local favorite Spanish ¬∑ lively vibe</div>
          </div>
          <div class="meal-star">‚òÖ</div>
        </div>
      </div>

      <div class="day-block">
        <div class="day-title">Sunday</div>
        <div class="meal-row" onclick="focusRestaurant('donghai')">
          <div class="meal-time">Brunch</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/maps/place/Hong+Kong+East+Ocean+Seafood+Restaurant/@37.8374689,-122.3148201" target="_blank">Hong Kong East Ocean (‰∏úÊµ∑)</a></div>
            <div class="meal-tag">HK caf√© ¬∑ congee, egg tarts, milk tea ¬∑ walk-in</div>
          </div>
          <div class="meal-star">‚òÖ</div>
        </div>
        <div class="meal-row">
          <div class="meal-time">Activity</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Cesar+Chavez+Park+Berkeley+CA" target="_blank">Berkeley Marina ¬∑ Cesar Chavez Park</a></div>
            <div class="meal-tag">Free ¬∑ bay views, kite flying ¬∑ right next to Skates</div>
          </div>
        </div>
        <div class="meal-row" onclick="focusRestaurant('skates')">
          <div class="meal-time">Lunch</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Skates+on+the+Bay+100+Seawall+Dr+Berkeley+CA" target="_blank">Skates on the Bay</a></div>
            <div class="meal-tag">Waterfront ¬∑ garlic bread ¬∑ wrap up the weekend here</div>
          </div>
          <div class="meal-star">‚òÖ</div>
        </div>
      </div>

      <div class="day-block">
        <div class="day-title">Swap-ins</div>
        <div class="meal-row" onclick="focusRestaurant('cafe-etoile')">
          <div class="meal-time">Picnic</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Cafe+Etoile+Berkeley+CA" target="_blank">Caf√© Etoile</a></div>
            <div class="meal-tag">Sandwiches + sushi ¬∑ take to a lawn</div>
          </div>
        </div>
        <div class="meal-row" onclick="focusRestaurant('secrets-of-tiger')">
          <div class="meal-time">Dinner</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Secrets+of+Tiger+Berkeley+CA" target="_blank">Secrets of Tiger</a></div>
            <div class="meal-tag">Thai ¬∑ walk-in ¬∑ solid backup dinner</div>
          </div>
        </div>
        <div class="meal-row" onclick="focusRestaurant('iyasare')">
          <div class="meal-time">Dinner</div>
          <div class="meal-info">
            <div class="meal-name"><a href="https://maps.google.com/?q=Iyasare+1830+4th+St+Berkeley+CA" target="_blank">Iyasare</a></div>
            <div class="meal-tag">Upscale Japanese on 4th St</div>
          </div>
        </div>
      </div>
    </div>

    <!-- Filter -->
    <div class="filter-bar">
      <button class="filter-btn active" onclick="filterCuisine('all', this)">All</button>
      <button class="filter-btn" data-cuisine="japanese" onclick="filterCuisine('japanese', this)">Japanese</button>
      <button class="filter-btn" data-cuisine="chinese"  onclick="filterCuisine('chinese', this)">Chinese</button>
      <button class="filter-btn" data-cuisine="thai"     onclick="filterCuisine('thai', this)">Thai</button>
      <button class="filter-btn" data-cuisine="spanish"  onclick="filterCuisine('spanish', this)">Spanish</button>
      <button class="filter-btn" data-cuisine="korean"   onclick="filterCuisine('korean', this)">Korean</button>
      <button class="filter-btn" data-cuisine="italian"  onclick="filterCuisine('italian', this)">Italian</button>
      <button class="filter-btn" data-cuisine="other"    onclick="filterCuisine('other', this)">Other</button>
    </div>

    <!-- Restaurant List -->
    <div class="rest-list" id="rest-list">
      <!-- populated by JS -->
    </div>
  </div>

  <!-- Map -->
  <div id="map"></div>
</div>

<script>
const RESTAURANTS = [
  {
    id: 'great-china',
    name: 'Great China',
    cuisine: 'chinese',
    cuisineLabel: 'Chinese',
    type: 'meal',
    lat: 37.8676588,
    lng: -122.2661805,
    address: '2190 Bancroft Way, Berkeley',
    url: 'https://maps.google.com/?q=Great+China+2190+Bancroft+Way+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/great-china-berkeley',
    note: 'Widely considered the best Chinese restaurant in the Bay Area. The Peking duck is legendary ‚Äî order ahead.',
    highlight: true,
    meal: 'Saturday Lunch ‚òÖ'
  },
  {
    id: 'ippuku',
    name: 'Ippuku',
    cuisine: 'japanese',
    cuisineLabel: 'Japanese ¬∑ Yakitori',
    type: 'meal',
    lat: 37.8702253,
    lng: -122.2670444,
    address: '2130 Center St, Berkeley',
    url: 'https://maps.google.com/?q=Ippuku+2130+Center+St+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/ippuku-berkeley',
    note: 'Authentic Kyoto-style izakaya. Best yakitori in Berkeley. Omakase courses available. Make reservations.',
    highlight: true,
    meal: 'Saturday Dinner ‚òÖ'
  },
  {
    id: 'kiraku',
    name: 'Kiraku',
    cuisine: 'japanese',
    cuisineLabel: 'Japanese ¬∑ Izakaya',
    type: 'meal',
    lat: 37.863683,
    lng: -122.258976,
    address: '2566 Telegraph Ave, Berkeley',
    url: 'https://maps.google.com/?q=Kiraku+2566+Telegraph+Ave+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/kiraku-berkeley',
    note: 'Cozy izakaya on Telegraph. Great small plates and sake selection.',
    highlight: false
  },
  {
    id: 'iyasare',
    name: 'Iyasare',
    cuisine: 'japanese',
    cuisineLabel: 'Japanese ¬∑ Upscale',
    type: 'meal',
    lat: 37.8693397,
    lng: -122.3007107,
    address: '1830 4th St, Berkeley',
    url: 'https://maps.google.com/?q=Iyasare+1830+4th+St+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/iyasare-berkeley',
    note: 'Refined Japanese cuisine on the 4th St shopping corridor. Beautiful plating, seasonal ingredients.',
    highlight: true,
    meal: 'Alt Saturday Dinner'
  },
  {
    id: 'donghai',
    name: 'Hong Kong East Ocean (‰∏úÊµ∑)',
    cuisine: 'chinese',
    cuisineLabel: 'HK Seafood ¬∑ Dim Sum',
    type: 'meal',
    lat: 37.8374689,
    lng: -122.3148201,
    address: '3199 Powell St, Emeryville',
    url: 'https://www.google.com/maps/place/Hong+Kong+East+Ocean+Seafood+Restaurant/@37.8374689,-122.317395,17z/data=!3m1!4b1!4m6!3m5!1s0x80857e531e59f20f:0x7abc71dd2cecc4ad!8m2!3d37.8374689!4d-122.3148201!16s%2Fg%2F1v1tn9dv?entry=ttu&g_ep=EgoyMDI2MDIyNS4wIKXMDSoASAFQAw%3D%3D',
    yelp: 'https://www.yelp.com/biz/hong-kong-east-ocean-seafood-restaurant-emeryville',
    note: 'Classic Hong Kong-style seafood and dim sum. Weekend brunch is popular for congee, egg tarts, and milk tea.',
    highlight: true,
    meal: 'Sunday Brunch ‚òÖ'
  },
  {
    id: 'la-marcha',
    name: 'La Marcha Tapas Bar',
    cuisine: 'spanish',
    cuisineLabel: 'Spanish ¬∑ Tapas',
    type: 'meal',
    lat: 37.868586,
    lng: -122.292374,
    address: '2026 San Pablo Ave, Berkeley',
    url: 'https://maps.google.com/?q=La+Marcha+Tapas+Bar+2026+San+Pablo+Ave+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/la-marcha-berkeley',
    note: 'Beloved local Spanish tapas bar. Lively atmosphere, excellent patatas bravas and jam√≥n. A local go-to.',
    highlight: true,
    meal: 'Sat Dinner ‚òÖ'
  },
  {
    id: 'skates',
    name: 'Skates on the Bay',
    cuisine: 'seafood',
    cuisineLabel: 'American ¬∑ Seafood',
    type: 'meal',
    lat: 37.8636282,
    lng: -122.3178533,
    address: '100 Seawall Dr, Berkeley Marina',
    url: 'https://maps.google.com/?q=Skates+on+the+Bay+100+Seawall+Dr+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/skates-on-the-bay-berkeley',
    note: 'Stunning bay views with the SF skyline. Famous for its garlic bread. Perfect Sunday send-off lunch.',
    highlight: true,
    meal: 'Sunday Lunch ‚òÖ'
  },
  {
    id: 'secrets-of-tiger',
    name: 'Secrets of Tiger',
    cuisine: 'thai',
    cuisineLabel: 'Thai',
    type: 'meal',
    lat: 37.8471438,
    lng: -122.2914834,
    address: '6520 Hollis St, Emeryville',
    url: 'https://maps.google.com/?q=Secrets+of+Tiger+6520+Hollis+St+Emeryville+CA',
    yelp: 'https://www.yelp.com/search?find_desc=Secrets+of+Tiger&find_loc=Emeryville%2C+CA',
    note: 'Solid Thai spot in Emeryville. Good curries and noodle dishes.',
    highlight: false
  },
  {
    id: 'marica',
    name: 'Marica',
    cuisine: 'seafood',
    cuisineLabel: 'Seafood ¬∑ American',
    type: 'meal',
    lat: 37.8380676,
    lng: -122.2514473,
    address: '5301 College Ave, Oakland',
    url: 'https://maps.google.com/?q=Marica+Oakland+CA',
    yelp: 'https://www.yelp.com/biz/marica-oakland',
    note: 'Fresh seafood, neighborhood gem. Great oysters and fish dishes.',
    highlight: false
  },
  {
    id: 'moo-bong-ri',
    name: 'Moo Bong Ri',
    cuisine: 'korean',
    cuisineLabel: 'Korean ¬∑ Ribs',
    type: 'meal',
    lat: 37.8322128,
    lng: -122.2629178,
    address: '4390 Telegraph Ave, Oakland',
    url: 'https://maps.google.com/?q=Moo+Bong+Ri+Oakland+CA',
    yelp: 'https://www.yelp.com/biz/moo-bong-ri-oakland',
    note: 'Korean cheese ribs ‚Äî a fun, indulgent spot. Very photogenic dish.',
    highlight: false
  },
  {
    id: 'yume-mori',
    name: 'Yume Mori',
    cuisine: 'dessert',
    cuisineLabel: 'Japanese ¬∑ Dessert',
    type: 'snack',
    lat: 37.8673077,
    lng: -122.2674516,
    address: '2319 Shattuck Ave, Berkeley',
    url: 'https://maps.google.com/?q=Yume+Mori+Matcha+Crepe+Berkeley+CA',
    yelp: 'https://www.yelp.com/search?find_desc=Yume+Mori&find_loc=Berkeley%2C+CA',
    note: 'Matcha crepes and Japanese-style desserts. Lovely afternoon stop on Shattuck Ave.',
    highlight: false
  },
  {
    id: 'cafe-etoile',
    name: 'Caf√© Etoile',
    cuisine: 'other',
    cuisineLabel: 'Caf√© ¬∑ Sandwiches',
    type: 'tea',
    lat: 37.8722437,
    lng: -122.2733584,
    address: '1930 MLK Jr Way, Berkeley',
    url: 'https://maps.google.com/?q=Cafe+Etoile+Berkeley+CA',
    yelp: 'https://www.yelp.com/search?find_desc=Cafe+Etoile&find_loc=Berkeley%2C+CA',
    note: 'Grab sandwiches or sushi and take them to a lawn for a picnic. Relaxed and charming.',
    highlight: false
  },
  {
    id: 'plantea',
    name: 'Plentea',
    cuisine: 'other',
    cuisineLabel: 'Plant-based ¬∑ Caf√©',
    type: 'tea',
    lat: 37.8673144,
    lng: -122.2594937,
    address: '2430 Durant Ave, Berkeley',
    url: 'https://maps.google.com/?q=Plentea+Berkeley+CA',
    yelp: 'https://www.yelp.com/search?find_desc=Plantea&find_loc=Berkeley%2C+CA',
    note: 'Plant-based caf√©. Great for a light meal or if anyone in the group is vegetarian/vegan.',
    highlight: false
  },
  {
    id: 'fogo',
    name: 'Fogo de Chao (Emeryville)',
    cuisine: 'other',
    cuisineLabel: 'Brazilian BBQ',
    type: 'meal',
    lat: 37.8347147,
    lng: -122.2923946,
    address: '5633 Bay St, Emeryville',
    url: 'https://maps.google.com/?q=Fogo+de+Chao+Emeryville+CA',
    yelp: 'https://www.yelp.com/biz/fogo-de-ch%C3%A3o-brazilian-steakhouse-emeryville-2',
    note: 'All-you-can-eat Brazilian churrasco. Big, festive, great for groups. A short drive into Emeryville.',
    highlight: false
  },
  {
    id: 'ippudo',
    name: 'Ippudo',
    cuisine: 'japanese',
    cuisineLabel: 'Japanese ¬∑ Ramen',
    type: 'meal',
    lat: 37.8719152,
    lng: -122.2675596,
    address: '2015 Kala Bagai Way, Berkeley',
    url: 'https://maps.google.com/?q=Ippudo+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/ippudo-berkeley',
    note: 'Popular ramen chain with a strong Berkeley following. Rich tonkotsu broth, great for a quick hearty meal.',
    highlight: false
  },
  {
    id: 'u-dessert',
    name: 'U:Dessert Story',
    cuisine: 'dessert',
    cuisineLabel: 'Dessert ¬∑ Taiwanese',
    type: 'snack',
    lat: 37.8740203,
    lng: -122.2684191,
    address: '1849 Shattuck Ave, Berkeley',
    url: 'https://www.google.com/maps/place/U+:Dessert+Story/@37.8740203,-122.270994,17z/data=!3m1!4b1!4m6!3m5!1s0x80857f0bc2fa54b3:0x92b95255dbd47ab5!8m2!3d37.8740203!4d-122.2684191!16s%2Fg%2F11fs2z9qy9?entry=ttu&g_ep=EgoyMDI2MDIyNS4wIKXMDSoASAFQAw%3D%3D',
    yelp: 'https://www.yelp.com/biz/u-dessert-story-berkeley',
    note: 'Taiwanese-style dessert shop. Shaved ice, mochi, and creative sweet drinks.',
    highlight: false
  },
  {
    id: 'sheng-kee',
    name: 'Sheng Kee Bakery',
    cuisine: 'dessert',
    cuisineLabel: 'Japanese Bakery',
    type: 'snack',
    lat: 37.8684814,
    lng: -122.258931,
    address: '2307 Telegraph Ave, Berkeley',
    url: 'https://maps.google.com/?q=Sheng+Kee+Bakery+2307+Telegraph+Ave+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/sheng-kee-bakery-berkeley',
    note: 'Japanese bakery chain. Great for pineapple buns, egg tarts, and soft bread. Good quick snack stop on Telegraph.',
    highlight: false
  },
  {
    id: 'tanzees',
    name: "Tanzie's (Ê∏ÖËøà Brunch)",
    cuisine: 'thai',
    cuisineLabel: 'Thai ¬∑ Brunch',
    type: 'meal',
    lat: 37.862261,
    lng: -122.2814784,
    address: '1453 Dwight Way, Berkeley',
    url: 'https://maps.google.com/?q=Tanzies+1453+Dwight+Way+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/tanzies-berkeley',
    note: 'Chiang Mai-inspired Thai brunch cafe. Casual, no reservations needed. Great way to start the morning.',
    highlight: true,
    meal: 'Sat Brunch ‚òÖ'
  },
  {
    id: 'passione-emporio',
    name: 'Passione Emporio / Hot Italian',
    cuisine: 'italian',
    cuisineLabel: 'Italian ¬∑ Pizza & Pasta',
    type: 'meal',
    lat: 37.8623558,
    lng: -122.2972233,
    address: '2324A 5th St, Berkeley',
    url: 'https://maps.google.com/?q=Passione+Emporio+2324+5th+St+Berkeley+CA',
    yelp: 'https://www.yelp.com/biz/passione-emporio-berkeley-5',
    note: 'Authentic Italian trattoria in West Berkeley. Wood-fired pizza, handmade pasta, and gelato. Chef from Cinque Terre sources local organic ingredients.',
    highlight: false
  }
];

// Anchor points
const ANCHORS = [
  { name: 'Jones Berkeley (1080 Jones St)', lat: 37.875856, lng: -122.2949862, icon: 'üè†' },
  { name: 'Aiden by Best Western (1499 University Ave)', lat: 37.8694, lng: -122.2892, icon: 'üè®' }
];

const cuisineColors = {
  japanese: '#5b7fa6',
  chinese:  '#c04a2a',
  thai:     '#2d8c5e',
  spanish:  '#b8831a',
  korean:   '#8a4fa8',
  seafood:  '#2c7098',
  brazilian:'#3a7a35',
  dessert:  '#b05080',
  italian:  '#c46528',
  other:    '#6b8a7a'
};

// Init map
const map = L.map('map', { zoomControl: false }).setView([37.860, -122.273], 13);
L.control.zoom({ position: 'topleft' }).addTo(map);

L.tileLayer('https://{s}.basemaps.cartocdn.com/light_all/{z}/{x}/{y}{r}.png', {
  attribution: '&copy; OpenStreetMap contributors &copy; CARTO',
  maxZoom: 19
}).addTo(map);

// Custom marker
function makeIcon(color, isHighlight, type) {
  const size = isHighlight ? 13 : 9;
  const ring = isHighlight ? `<circle cx="16" cy="16" r="14" fill="none" stroke="${color}" stroke-width="2.5" opacity="0.35"/>` : '';
  let shape;
  if (type === 'snack') {
    const s = size * 0.82;
    shape = `<rect x="${16-s}" y="${16-s}" width="${s*2}" height="${s*2}" fill="${color}" opacity="0.92" transform="rotate(45 16 16)"/>`;
  } else if (type === 'tea') {
    const s = size * 0.82;
    shape = `<rect x="${16-s}" y="${16-s}" width="${s*2}" height="${s*2}" rx="5" fill="${color}" opacity="0.92"/>`;
  } else {
    shape = `<circle cx="16" cy="16" r="${size}" fill="${color}" opacity="0.92"/>`;
  }
  const dot = isHighlight ? `<circle cx="16" cy="16" r="4" fill="white" opacity="0.75"/>` : '';
  const svg = `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="32" viewBox="0 0 32 32">
    ${ring}${shape}${dot}
  </svg>`;
  return L.divIcon({
    html: svg,
    className: '',
    iconSize: [32, 32],
    iconAnchor: [16, 16],
    popupAnchor: [0, -18]
  });
}

// Anchor markers
ANCHORS.forEach(a => {
  const anchorSvg = `<svg xmlns="http://www.w3.org/2000/svg" width="32" height="40" viewBox="0 0 32 40">
    <path d="M16 2 C8 2 2 8 2 16 C2 26 16 38 16 38 C16 38 30 26 30 16 C30 8 24 2 16 2Z" fill="#2c3e2d" stroke="white" stroke-width="1.5"/>
    <circle cx="16" cy="15" r="6" fill="white"/>
  </svg>`;
  L.marker([a.lat, a.lng], {
    icon: L.divIcon({ html: anchorSvg, className: '', iconSize: [32, 40], iconAnchor: [16, 38], popupAnchor: [0, -40] })
  }).bindPopup(`<div style="font-family:'DM Sans',sans-serif;font-size:0.85rem;font-weight:500">${a.icon} ${a.name}</div>`).addTo(map);
});

// Restaurant markers
const markers = {};
let activeFilter = 'all';

function buildMarkers() {
  RESTAURANTS.forEach(r => {
    if (markers[r.id]) markers[r.id].remove();
    const color = cuisineColors[r.cuisine] || '#6b8a7a';
    const marker = L.marker([r.lat, r.lng], { icon: makeIcon(color, r.highlight, r.type) });
    const mealBadge = r.meal ? `<span class="popup-highlight">${r.meal}</span>` : '';
    const yelpLink = r.yelp ? `<a href="${r.yelp}" target="_blank" style="color:#c0612b;font-size:0.72rem;font-weight:500;text-decoration:none;margin-left:8px">Yelp ‚Üó</a>` : '';
    marker.bindPopup(`
      <div>
        <div class="popup-name">
          <a href="${r.url}" target="_blank" style="color:inherit;text-decoration:none;border-bottom:1px solid #c0612b">${r.name}</a>${yelpLink}
        </div>
        <div class="popup-cuisine">${r.cuisineLabel}</div>
        <div class="popup-note">${r.note}</div>
        ${mealBadge}
      </div>
    `);
    marker.addTo(map);
    markers[r.id] = marker;
  });
}

buildMarkers();

// Filter state
let activeCuisine = null;
let activeType = null;

function applyFilters() {
  const filtered = RESTAURANTS.filter(r => {
    const cuisineOk = !activeCuisine || r.cuisine === activeCuisine;
    const typeOk = !activeType || r.type === activeType;
    return cuisineOk && typeOk;
  });
  const ids = new Set(filtered.map(r => r.id));
  RESTAURANTS.forEach(r => {
    if (!markers[r.id]) return;
    ids.has(r.id) ? markers[r.id].addTo(map) : markers[r.id].remove();
  });
  const el = document.getElementById('rest-list');
  el.innerHTML = filtered.map(r => {
    const color = cuisineColors[r.cuisine] || '#6b8a7a';
    const starBadge = r.highlight ? `<span class="star-badge">‚òÖ Pick</span>` : '';
    return `<div class="rest-card ${r.highlight ? 'highlight' : ''}" onclick="focusRestaurant('${r.id}')">
      <div class="pin-dot ${r.cuisine}" style="background:${color}">${r.cuisineLabel.charAt(0)}</div>
      <div class="rest-info">
        <div class="rest-name"><a href="${r.url}" target="_blank" onclick="event.stopPropagation()">${r.name}</a>${starBadge}</div>
        <div class="rest-meta">${r.cuisineLabel} ¬∑ ${r.meal ? r.meal : r.address.split(',')[0]}</div>
      </div>
    </div>`;
  }).join('');
}

applyFilters();

function focusRestaurant(id) {
  const r = RESTAURANTS.find(x => x.id === id);
  if (!r) return;
  map.flyTo([r.lat, r.lng], 15, { duration: 0.8 });
  setTimeout(() => markers[id] && markers[id].openPopup(), 850);
}

function filterCuisine(cuisine, btn) {
  if (cuisine === 'all') {
    activeCuisine = null;
  } else {
    activeCuisine = (activeCuisine === cuisine) ? null : cuisine;
  }
  // sync sidebar buttons
  document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
  if (!activeCuisine) document.querySelector('.filter-btn').classList.add('active');
  else btn.classList.add('active');
  // sync legend cuisine rows
  document.querySelectorAll('.legend-cuisine-row').forEach(r => {
    r.classList.toggle('active', r.dataset.val === activeCuisine);
  });
  applyFilters();
}

function legendFilter(dim, val, rowEl) {
  if (dim === 'type') {
    activeType = (activeType === val) ? null : val;
    document.querySelectorAll('.legend-type-row').forEach(r => r.classList.remove('active'));
    if (activeType) rowEl.classList.add('active');
  } else {
    activeCuisine = (activeCuisine === val) ? null : val;
    document.querySelectorAll('.legend-cuisine-row').forEach(r => r.classList.remove('active'));
    if (activeCuisine) rowEl.classList.add('active');
    // sync sidebar buttons
    document.querySelectorAll('.filter-btn').forEach(b => b.classList.remove('active'));
    if (!activeCuisine) document.querySelector('.filter-btn').classList.add('active');
    else {
      const match = document.querySelector(`.filter-btn[data-cuisine="${activeCuisine}"]`);
      if (match) match.classList.add('active');
    }
  }
  applyFilters();
}

// Legend
const legend = L.control({ position: 'bottomright' });
legend.onAdd = () => {
  const div = L.DomUtil.create('div', 'legend');
  const typeRows = [
    { val: 'meal',  label: 'Meal',          svg: `<svg width="14" height="14" viewBox="0 0 14 14"><circle cx="7" cy="7" r="6" fill="#888"/></svg>` },
    { val: 'snack', label: 'Snack / Dessert',svg: `<svg width="14" height="14" viewBox="0 0 14 14"><rect x="2" y="2" width="10" height="10" transform="rotate(45 7 7)" fill="#888"/></svg>` },
    { val: 'tea',   label: 'Caf√© / Tea',     svg: `<svg width="14" height="14" viewBox="0 0 14 14"><rect x="2" y="2" width="10" height="10" rx="3" fill="#888"/></svg>` },
  ];
  const cuisineRows = [
    { val: 'japanese', label: 'Japanese', color: '#5b7fa6' },
    { val: 'chinese',  label: 'Chinese',  color: '#c04a2a' },
    { val: 'thai',     label: 'Thai',     color: '#2d8c5e' },
    { val: 'spanish',  label: 'Spanish',  color: '#b8831a' },
    { val: 'korean',   label: 'Korean',   color: '#8a4fa8' },
    { val: 'seafood',  label: 'Seafood',  color: '#2c7098' },
    { val: 'dessert',  label: 'Dessert',  color: '#b05080' },
    { val: 'other',    label: 'Other',    color: '#6b8a7a' },
  ];
  div.innerHTML =
    `<div class="legend-title">Shape ¬∑ Type</div>` +
    typeRows.map(r => `<div class="legend-row legend-type-row" data-val="${r.val}" onclick="legendFilter('type','${r.val}',this)">${r.svg} ${r.label}</div>`).join('') +
    `<div class="legend-title" style="margin-top:9px">Color ¬∑ Cuisine</div>` +
    cuisineRows.map(r => `<div class="legend-row legend-cuisine-row" data-val="${r.val}" onclick="legendFilter('cuisine','${r.val}',this)"><div class="legend-dot" style="background:${r.color}"></div> ${r.label}</div>`).join('') +
    `<div class="legend-title" style="margin-top:9px">Ring ¬∑ Highlight</div>` +
    `<div class="legend-row" style="cursor:default"><svg width="14" height="14" viewBox="0 0 14 14"><circle cx="7" cy="7" r="6" fill="#c0612b" opacity="0.9"/><circle cx="7" cy="7" r="3" fill="white" opacity="0.75"/></svg> Recommended</div>`;
  return div;
};
legend.addTo(map);
</script>
</body>
</html>
